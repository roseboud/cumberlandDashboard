
        <!-- Layer Controls -->
        <div class="sidebar-section">
            <h2><span class="icon">üó∫Ô∏è</span> Map Layers</h2>
            <div class="layer-toggle">
                <input type="checkbox" id="layer-flood" checked>
                <span class="layer-color-swatch" style="background: rgba(0, 100, 255, 0.5);"></span>
                <label for="layer-flood">100-Year Flood Zones</label>
            </div>
            <div class="layer-toggle">
                <input type="checkbox" id="layer-roads" checked>
                <span class="layer-color-swatch" style="background: #ff6b35;"></span>
                <label for="layer-roads">Evacuation Routes</label>
            </div>
            <div class="layer-toggle">
                <input type="checkbox" id="layer-infra" checked>
                <span class="layer-color-swatch" style="background: #e94560;"></span>
                <label for="layer-infra">Critical Infrastructure</label>
            </div>
            <div class="layer-toggle">
                <input type="checkbox" id="layer-tides" checked>
                <span class="layer-color-swatch" style="background: #00d4ff;"></span>
                <label for="layer-tides">Tide Station Markers</label>
            </div>
        </div>

        <!-- Legend -->
        <div class="sidebar-section">
            <h2><span class="icon">üè∑Ô∏è</span> Legend</h2>
            <div class="legend-items">
                <div class="legend-item">
                    <div class="legend-area" style="background: rgba(0, 100, 255, 0.4);"></div>
                    <span>High Risk Flood Zone (1-in-100 yr)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-area" style="background: rgba(0, 180, 255, 0.3);"></div>
                    <span>Medium Risk Flood Zone</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background: #ff6b35;"></div>
                    <span>Primary Evacuation Route</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line" style="background: #ffaa00;"></div>
                    <span>Secondary Evacuation Route</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #e94560;"></div>
                    <span>Emergency Services</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #00c853;"></div>
                    <span>Healthcare Facility</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #00d4ff;"></div>
                    <span>Tide Monitoring Station</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #aa66ff;"></div>
                    <span>User-Uploaded Layer</span>
                </div>
            </div>
        </div>

        <!-- File Upload -->
        <div class="sidebar-section">
            <h2><span class="icon">üìÇ</span> Add Layer</h2>
            <div class="upload-zone" id="upload-zone">
                <div class="upload-icon">üì§</div>
                <p>Drop file here or click to browse</p>
                <div class="upload-formats">Supported: .geojson, .json, .csv</div>
                <input type="file" id="file-input" accept=".json,.geojson,.csv" />
            </div>
            <div class="user-layers-list" id="user-layers-list"></div>
        </div>

        <!-- Attribution -->
        <div class="sidebar-section" style="font-size:0.65rem; color:#4a5a78; line-height:1.6;">
            <strong>Data Sources:</strong> CHS/DFO-MPO (Tides), OpenStreetMap (Base Map).<br>
            <strong>Project:</strong> INFT3000 Capstone ‚Äî Cumberland County Floodmap.<br>
            <strong>Note:</strong> Flood zones are illustrative prototypes pending LiDAR vectorization.
        </div>
    </aside>

    <!-- ======== MAP AREA ======== -->
    <div class="map-area">
        <div id="map"></div>
        <div class="map-info-box" id="map-info-box">
            <h3>Cursor Position</h3>
            <div class="info-row">
                <span class="info-label">Lat:</span>
                <span class="info-value" id="cursor-lat">‚Äî</span>
            </div>
            <div class="info-row">
                <span class="info-label">Lng:</span>
                <span class="info-value" id="cursor-lng">‚Äî</span>
            </div>
            <div class="info-row">
                <span class="info-label">Zoom:</span>
                <span class="info-value" id="cursor-zoom">‚Äî</span>
            </div>
        </div>
    </div>
</div>

<!-- Toast container -->
<div class="toast" id="toast"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>

<script>
// ============================================
// CUMBERLAND FLOOD DASHBOARD ‚Äî MAIN LOGIC
// ============================================

// ---------- UTILITIES ----------
function showToast(message, type = 'info') {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = 'toast ' + type + ' show';
    setTimeout(() => { toast.className = 'toast'; }, 3500);
}

function formatTimestamp(isoStr) {
    try {
        const d = new Date(isoStr);
        return d.toLocaleString('en-CA', {
            timeZone: 'America/Halifax',
            year: 'numeric', month: 'short', day: 'numeric',
            hour: '2-digit', minute: '2-digit', second: '2-digit'
        }) + ' AST';
    } catch (e) { return isoStr; }
}
